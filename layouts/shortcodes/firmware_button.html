{{ if .Get "hex" }}
{{ if .Get "oledImage" }}
<div class="oled-preview-container">
  <img src="{{ .Get "oledImage" }}" alt="{{ .Get "buttonText" }} OLED preview" class="oled-preview-image">
</div>
{{ end }}

<div class="flash-firmware" data-hex-base="{{ .Get "hex" | safeURL }}">
  <button
    class="flash-button upload-button flash-button-old-bootloader"
    arduino-uploader
    hex-href='/releases/{{ .Get "hex" | safeURL }}.nanoOldBootloader.hex'
    board="nanoOldBootloader"
  >
    <span class="button-icon">⬆️</span>
    {{ with .Get "buttonText" }}{{ . | plainify }}{{ else -}} Upload Firmware {{ end }}
    <span class="upload-progress"></span>
  </button>

  <!-- Progress Bar -->
  <div class="upload-progress-container">
    <div class="progress-bar-track">
      <div class="progress-bar-fill"></div>
    </div>
    <div class="progress-stats">
      <span class="progress-percent">0%</span>
      <span class="progress-status">Ready to upload</span>
    </div>
  </div>

  <div class="advanced-options">
    <label class="checkbox-label">
      <input type="checkbox" class="bootloader-toggle">
      <span>Use new bootloader (most Nanos after 2018)</span>
    </label>
  </div>

  <!-- Hidden button for new bootloader -->
  <button
    class="flash-button upload-button flash-button-nano"
    style="display: none;"
    arduino-uploader
    hex-href='/releases/{{ .Get "hex" | safeURL }}.nano.hex'
    board="nano"
  >
    <span class="button-icon">⬆️</span>
    {{ with .Get "buttonText" }}{{ . | plainify }}{{ else -}} Upload Firmware {{ end }}
    <span class="upload-progress"></span>
  </button>
</div>
{{ end }}
